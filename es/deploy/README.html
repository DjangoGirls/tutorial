<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>readme</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="README_files/libs/clipboard/clipboard.min.js"></script>
<script src="README_files/libs/quarto-html/quarto.js"></script>
<script src="README_files/libs/quarto-html/popper.min.js"></script>
<script src="README_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="README_files/libs/quarto-html/anchor.min.js"></script>
<link href="README_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="README_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="README_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="README_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="README_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">




<section id="despliega" class="level1">
<h1>¡Despliega!</h1>
<blockquote class="blockquote">
<p><strong>Nota</strong> El siguiente capítulo puede ser, a veces, un poco difícil de seguir. Ten paciencia y acábalo. El despliegue es una parte importante del proceso en el desarrollo de un sitio web. Este capítulo está a mitad del tutorial para que tu mentor pueda ayudarte a conseguir que tu sitio web esté online, algo que puede ser un poco complicado. Así, aunque se te acabe el tiempo, podrás terminar el tutorial por tu cuenta.</p>
</blockquote>
<p>Hasta ahora, tu sitio web sólo está disponible en tu ordenador. ¡Ahora aprenderás como desplegarlo! El despliegue es el proceso de publicar tu aplicación en internet para que la gente pueda acceder y ver tu sitio web. :)</p>
<p>Como ya has aprendido, un sitio web tiene que estar en un servidor. Hay muchos proveedores de servidores disponibles en internet, nosotros vamos a usar <a href="https://www.pythonanywhere.com/">PythonAnywhere</a>. PythonAnywhere es gratuito para aplicaciones pequeñas que no tienen muchos visitantes, y con eso tendrás más que suficiente por ahora.</p>
<p>El otro servicio externo que vamos a utilizar es <a href="https://www.github.com">GitHub</a>, un servicio de almacenamiento de código. Hay otras opciones por ahí, pero hoy en día casi todas las programadoras y programadores tenemos una cuenta de GitHub, ¡y ahora tú también la vas a tener!</p>
<p>Estos tres lugares serán importantes para ti. Tu ordenador local será el lugar donde desarrollas y pruebas. Cuando estés contento con los cambios, subirás una versión de tu programa a GitHub. Tu sitio web estará en PythonAnywhere y para actualizarlo descargarás la última versión de tu código desde GitHub.</p>
</section>
<section id="git" class="level1">
<h1>Git</h1>
<blockquote class="blockquote">
<p><strong>Nota</strong> Si ya has realizado los pasos de instalación, no los tienes que repetir, puedes avanzar a la siguiente sección y empezar a crear tu repositorio de Git.</p>
</blockquote>
<p>{% include “/deploy/install_git.md” %}</p>
<section id="crear-nuestro-repositorio-git" class="level2">
<h2 class="anchored" data-anchor-id="crear-nuestro-repositorio-git">Crear nuestro repositorio Git</h2>
<p>Git sigue los cambios realizados a un grupo determinado de archivos en lo que llamamos un repositorio de código (abreviado “repo”). Vamos a crear uno para nuestro proyecto. Abre la consola y ejecuta los siguientes comandos en el directorio de <code>djangogirls</code>:</p>
<blockquote class="blockquote">
<p><strong>Nota</strong> Comprueba en qué directorio estás ahora mismo (es decir, el directorio de trabajo actual) con el comando <code>pwd</code> (OSX/Linux) o <code>cd</code> (Windows) antes de inicializar el repositorio. Deberías estar en la carpeta <code>djangogirls</code>.</p>
</blockquote>
<p>{% filename %}command-line{% endfilename %}</p>
<pre><code>$ git init
Initialized empty Git repository in ~/djangogirls/.git/
$ git config --global user.name "Tu nombre"
$ git config --global user.email tu@ejemplo.com</code></pre>
<p>Inicializar el repositorio de git es algo que sólo tenemos que hacer una vez por proyecto (y no tendrás que volver a teclear tu nombre de usuario y correo electrónico nunca más).</p>
<p>Git llevará un seguimiento de los cambios realizados en todos los archivos y carpetas en este directorio, pero hay algunos archivos que queremos que ignore. Esto lo hacemos creando un archivo llamado <code>.gitignore</code> en el directorio base. Abre tu editor y crea un nuevo archivo con el siguiente contenido:</p>
<p>{% filename %}.gitignore{% endfilename %}</p>
<pre><code>*.pyc
*~
__pycache__
myvenv
db.sqlite3
/static
.DS_Store</code></pre>
<p>Y guárdalo como <code>.gitignore</code> en la carpeta “djangogirls”.</p>
<blockquote class="blockquote">
<p><strong>Nota</strong> ¡El punto al principio del nombre del archivo es importante! Si tienes problemas para crearlo (a los Mac no les gusta que crees ficheros con un punto al principio del nombre usando el Finder por ejemplo), entonces usa la opción “Save As” o “Guardar como” de tu editor, esto funcionará seguro. Asegúrate de no añadir <code>.txt</code>, <code>.py</code>, o ninguna otra extensión al nombre de fichero – Git solo lo reconocerá si se llama exactamente <code>.gitignore</code>, sin nada más.</p>
<p><strong>Nota</strong> Uno de los archivos especificados en tu <code>.gitignore</code> es <code>db.sqlite3</code>. Ese fichero es tu base de datos local, donde se almacenan los usuarios y publicaciones de tu blog. Vamos a seguir las buenas prácticas de programación web: vamos a usar bases de datos separadas para tu sitio local y tu sitio en producción en PythonAnywhere. La base de datos en PythonAnywhere podría ser SQLite, como en tu máquina de desarrollo, pero también podrías usar otro gestor de base de datos como MySQL o PostgreSQL que pueden soportar muchas más visitas que SQLite. En cualquier caso, al ignorar la base de datos SQLite en tu copia de GitHub, todos los posts y el super usuario que has creado hasta el momento solo estarán disponibles en local, y tendrás que crear nuevos usuarios y publicaciones en producción. Tu base de datos local es un buen campo de pruebas donde puedes probar diferentes cosas sin miedo a estropear o borrar las publicaciones reales de tu blog.</p>
</blockquote>
<p>Te recomendamos utilizar el comando <code>git status</code> antes de <code>git add</code> o en cualquier momento en que no sepas muy bien lo que ha cambiado. Esto te ayudará a evitar sorpresas, como subir cambios o archivos que no queríamos subir. El comando <code>git status</code> muestra información sobre cualquier archivo no seguido (“untracked”), modificado (“modified”), preparado (“staged”), el estado de la rama y muchas cosas más. La salida debería ser parecida a esto:</p>
<p>{% filename %}command-line{% endfilename %}</p>
<pre><code>$ git status
On branch master

No commits yet

Untracked files:
  (use "git add &lt;file&gt;..." to include in what will be committed)

        .gitignore
        blog/
        manage.py
        mysite/
        requirements.txt

nothing added to commit but untracked files present (use "git add" to track)</code></pre>
<p>Y finalmente guardamos nuestros cambios. Ve a la consola y ejecuta estos comandos:</p>
<p>{% filename %}command-line{% endfilename %}</p>
<pre><code>$ git add --all .
$ git commit -m "Mi aplicación Django Girls, primer commit"
 [...]
 13 files changed, 200 insertions(+)
 create mode 100644 .gitignore
 [...]
 create mode 100644 mysite/wsgi.py</code></pre>
</section>
<section id="subiendo-tu-código-a-github" class="level2">
<h2 class="anchored" data-anchor-id="subiendo-tu-código-a-github">Subiendo tu código a Github</h2>
<p>Vete a <a href="https://www.github.com">GitHub.com</a> y regístrate para obtener una cuenta de usuario nueva y gratuita. (Si ya lo hiciste en la preparación del taller, ¡eso es genial!) Asegúrate de recordar tu contraseña (agrégala a tu administrador de contraseñas, si usas uno).</p>
<p>A continuación, crea un nuevo repositorio con el nombre “my-first-blog”. Deja el checkbox “initialize with a README” sin marcar, deja la opción de .gitignore vacía (ya lo hemos hecho manualmente) y deja la licencia como None.</p>
<p><img src="images/new_github_repo.png" class="img-fluid"></p>
<blockquote class="blockquote">
<p><strong>Nota</strong> El nombre <code>my-first-blog</code> es importante - podrías escoger otro, pero va a salir muchas veces en las instrucciones que vienen a continuación, y vas a tener que acordarte de cambiarlo cada vez. Lo más fácil es quedarse con el nombre <code>my-first-blog</code>.</p>
</blockquote>
<p>En la siguiente pantalla, verás la URL para clonar el repo, que tendrás que usar en los comandos que van a continuación:</p>
<p><img src="images/github_get_repo_url_screenshot.png" class="img-fluid"></p>
<p>Ahora necesitas enlazar el repositorio Git en tu ordenador con el repositorio de GitHub.</p>
</section>
<section id="generar-un-tocken-de-github" class="level2">
<h2 class="anchored" data-anchor-id="generar-un-tocken-de-github">Generar un tocken de GitHub</h2>
<p>Para subir tu código a GitHub, necesitas autenticarte. Para ello, necesitas un token de GitHub. Sigue las instrucciones en <a href="https://github.com/settings/tokens/new">este enlace</a> para generar un token de GitHub. Asegúrate de seleccionar la opción <code>repo</code> en la lista de permisos.</p>
<p>Sigamos los siguientes pasos:</p>
<ol type="1">
<li>Ingresar a la página de <a href="https://github.com/settings/tokens/new">tokens de GitHub</a></li>
<li>En el campo note, escribe un nombre para identificar el token, por ejemplo</li>
</ol>
<p><img src="images/paste-1.png" class="img-fluid"></p>
<ol start="3" type="1">
<li>En la sección <strong>Expiration</strong> selecciona una fecha de expiración para el token, por ejemplo</li>
</ol>
<p><img src="images/paste-2.png" class="img-fluid"></p>
<ol start="4" type="1">
<li>En la sección <strong>Select scopes</strong>, selecciona la opción <code>repo</code></li>
<li>Haz click en el botón <strong>Generate token</strong></li>
</ol>
<p><img src="images/paste-3.png" class="img-fluid"></p>
<p>Si todo salio bien debe aparecernos algo como esto:</p>
<p><img src="images/paste-4.png" class="img-fluid"></p>
<p>Almacena este token en un lugar seguro ya que no se podrá visualizar nuevamente y lo necesitarás para subir tu código a GitHub.</p>
<blockquote class="blockquote">
<p><strong>Nota</strong> Si no deseas agregar cada vez el token generado, es necesario actualizar las creadenciales de acceso:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> config <span class="at">--global</span> credential.helper store</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</blockquote>
<div class="tip">
<p>Github a partir de 2021 ha deshabilitado el uso de usuario y contraseña para autenticarse, por lo que es necesario usar un token de acceso.</p>
</div>
<p>Escribe lo siguiente en la consola (cambia <code>&lt;your-github-username&gt;</code> por tu nombre de usuario de GitHub, pero sin los símbolos &lt; y &gt; – fíjate en que la URL debería coincidir con la URL para clonar el repo que acabas de ver):</p>
<p>{% filename %}command-line{% endfilename %}</p>
<pre><code>$ git remote add origin https://github.com/&lt;your-github-username&gt;/my-first-blog.git
$ git push -u origin master</code></pre>
<p>Cuando hagas push a GitHub, te preguntará tu usuario y password de GitHub, y después de introducirlos, deberías ver algo como esto:</p>
<p>{% filename %}command-line{% endfilename %}</p>
<pre><code>Counting objects: 6, done.
Writing objects: 100% (6/6), 200 bytes | 0 bytes/s, done.
Total 3 (delta 0), reused 0 (delta 0)
To https://github.com/ola/my-first-blog.git

 * [new branch]      master -&gt; master
Branch master set up to track remote branch master from origin.</code></pre>
<!--TODO: maybe do ssh keys installs in install party, and point ppl who dont have it to an extension -->
<p>Tu código ya está subido a GitHub. ¡Ve y compruébalo! Encontrarás que está en buena compañía - <a href="https://github.com/django/django">Django</a>, <a href="https://github.com/DjangoGirls/tutorial">Django Girls Tutorial</a> y muchos otros proyectos de software libre están alojados en GitHub. :)</p>
</section>
</section>
<section id="configurar-nuestro-blog-en-pythonanywhere" class="level1">
<h1>Configurar nuestro blog en PythonAnywhere</h1>
<section id="crea-una-cuenta-en-pythonanywhere" class="level2">
<h2 class="anchored" data-anchor-id="crea-una-cuenta-en-pythonanywhere">Crea una cuenta en PythonAnywhere</h2>
<blockquote class="blockquote">
<p><strong>Nota</strong> A lo mejor ya has creado una cuenta en PythonAnywhere durante los pasos de instalación. Si es así, no necesitas hacerlo otra vez.</p>
</blockquote>
<p>{% include “/deploy/signup_pythonanywhere.md” %}</p>
</section>
<section id="configurar-nuestro-sitio-en-pythonanywhere" class="level2">
<h2 class="anchored" data-anchor-id="configurar-nuestro-sitio-en-pythonanywhere">Configurar nuestro sitio en PythonAnywhere</h2>
<p>Vuelve al <a href="https://www.pythonanywhere.com/">dashboard de PythonAnywhere</a> haciendo click en el logo, y escoge la opción de iniciar una consola “Bash” – esta terminal es como la que hay en tu ordenador, pero en el servidor de PythonAnywhere.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/pythonanywhere_bash_console.png" class="img-fluid figure-img"></p>
<figcaption>La sección ‘New Console’ en la interfaz de PythonAnywhere con un botón para ‘bash’</figcaption>
</figure>
</div>
<blockquote class="blockquote">
<p><strong>Nota</strong> PythonAnywhere está basado en Linux, así que si estás en Windows, la consola será un poco distinta a la de tu ordenador.</p>
</blockquote>
<p>Para desplegar una aplicación web en PythonAnywhere necesitas descargar tu código de GitHub y configurar PythonAnywhere para que lo reconozca y lo sirva como una aplicación web. Hay formas de hacerlo manualmente, pero PythonAnywhere tiene una herramienta automática que lo hará todo por nosotros. Lo primero, vamos a instalar la herramienta:</p>
<p>{% filename %}PythonAnywhere command-line{% endfilename %}</p>
<pre><code>$ pip3.6 install --user pythonanywhere</code></pre>
<p>Eso debería mostrar en pantalla algunos mensajes como <code>Collecting pythonanywhere</code>, y finalmente una linea diciendo que ha terminado bien: <code>Successfully installed (...) pythonanywhere- (...)</code>.</p>
<p>Ahora ejecutaremos el asistente para configurar automáticamente nuestra aplicación desde GitHub. Teclea lo siguiente en la consola de PythonAnywhere (no te olvides de usar tu propio nombre de usuario de GitHub en lugar de <code>&lt;your-github-username&gt;</code>, para que la URL sea como la URL de clonar el repo de GitHub):</p>
<p>{% filename %}PythonAnywhere command-line{% endfilename %}</p>
<pre><code>$ pa_autoconfigure_django.py --python=3.6 https://github.com/&lt;your-github-username&gt;/my-first-blog.git</code></pre>
<p>A medida que se ejecuta, podrás ver lo que hace:</p>
<ul>
<li>Se descarga tu código de GitHub.</li>
<li>Crea un virtualenv en PythonAnywhere, como el de tu propia computadora.</li>
<li>Actualiza tus ficheros de settings con algunos settings de despliegue.</li>
<li>Crea la base de datos en PythonAnywhere ejecutando el comando <code>manage.py migrate</code>.</li>
<li>Configura los archivos estáticos (static) (luego hablaremos de éstos con más detalle).</li>
<li>Y configura PythonAnywhere para publicar tu aplicación web a través de su API.</li>
</ul>
<p>En PythonAnywhere todos estos pasos están automatizados, pero son los mismos que tendrías que seguir en cualquier otro proveedor de servidores.</p>
<p>Lo más importante que debes notar en este momento es que tu base de datos en PythonAnywhere está totalmente separada de tu base de datos en tu propia computadora, por lo que puedes tener diferentes publicaciones y cuentas de administrador. Como consecuencia, igual que lo hicimos en tu ordenador, tenemos que crear la cuenta de administrador con el comando <code>createsuperuser</code>. PythonAnywhere ya ha activado el virtualenv automáticamente, así que lo único que tienes que hacer es ejecutar:</p>
<p>{% filename %}PythonAnywhere command-line{% endfilename %}</p>
<pre><code>(ola.pythonanywhere.com) $ python manage.py createsuperuser</code></pre>
<p>Teclea las credenciales para tu usuario admin. Para evitar confusiones, te recomendamos usar el mismo nombre de usuario que usaste en tu ordenador local; aunque a lo mejor prefieres que la contraseña en PythonAnywhere sea más segura.</p>
<p>Ahora, si quieres, también puedes ver tu código en PythonAnywhere con el comando <code>ls</code>:</p>
<p>{% filename %}PythonAnywhere command-line{% endfilename %}</p>
<pre><code>(ola.pythonanywhere.com) $ ls
blog  db.sqlite3  manage.py  mysite requirements.txt static
(ola.pythonanywhere.com) $ ls blog/
__init__.py  __pycache__  admin.py  apps.py  migrations  models.py
tests.py  views.py</code></pre>
<p>También puedes ir a la página de ficheros (“Files”) y navegar por los ficheros y directorios usando el visor de PythonAnywhere. (Desde la página de la consola (“Console”), puedes ir a cualquier otra página de PythonAnywhere usando el botón de la esquina superior derecha. Desde el resto de páginas, también hay enlaces a las otras en la parte superior.)</p>
</section>
<section id="ya-estás-en-vivo" class="level2">
<h2 class="anchored" data-anchor-id="ya-estás-en-vivo">¡Ya estás en vivo!</h2>
<p>¡Tu sitio ya debería estar online en internet! Haz click en la página “Web” de PythonAnywhere para obtener un enlace a él. Puedes compartir este enlace con quien tu quieras :)</p>
<blockquote class="blockquote">
<p><strong>Nota</strong> Este es un tutorial para principiantes, y al desplegar este sitio hemos tomado algunos atajos que tal vez no sean las mejores prácticas desde el punto de vista de la seguridad. Si decide construir sobre este proyecto, o comenzar un nuevo proyecto, debe revisar la <a href="https://docs.djangoproject.com/en/2.2/howto/deployment/checklist/">lista de verificación de despliegue de Django</a> para obtener algunos consejos sobre cómo proteger su sitio.</p>
</blockquote>
</section>
<section id="consejos-de-depuración" class="level2">
<h2 class="anchored" data-anchor-id="consejos-de-depuración">Consejos de depuración</h2>
<p>Si te sale un error al ejecutar el script <code>pa_autconfigure_django.py</code>, aquí hay algunas causas comunes:</p>
<ul>
<li>Te has olvidado de crear el token de API de PythonAnywhere.</li>
<li>No has puesto bien la URL de GitHub.</li>
<li>Si ves un error diciendo <em>“Could not find your settings.py</em>, es probable que no añadieras todos tus archivos a Git, y/o no los subiste a GitHub correctamente. Repasa la sección de Git más arriba.</li>
<li>Si anteriormente te suscribiste a una cuenta de PythonAnywhere y tuviste un error con <em>collectstatic</em>, probablemente tengas una versión antigua de SQLite (por ejemplo, 3.8.2) en tu cuenta. En este caso, regístrate con una nueva cuenta e intenta los comandos en la sección PythonAnywhere anterior.</li>
</ul>
<p>Si ves un error al visitar tu sitio, el primer lugar para ver qué está pasando es el <strong>log de errores</strong>. Encontrarás un enlace en la página <a href="https://www.pythonanywhere.com/web_app_setup/">“Web”</a> de PythonAnywhere. Mira si hay algún mensaje de error allí; los más recientes están en la parte inferior.</p>
<p>Hay también algunos <a href="http://help.pythonanywhere.com/pages/DebuggingImportError">consejos generales de depuración en la página de ayuda de PythonAnywhere</a>.</p>
<p>Y recuerda, ¡tu mentora está aquí para ayudar!</p>
</section>
</section>
<section id="comprueba-tu-página" class="level1">
<h1>¡Comprueba tu página!</h1>
<p>La página por defecto debería decir “It worked!”, tal como dice en tu ordenador local. Prueba a añadir <code>/admin/</code> al final de la URL y llegarás a la página de administración. Entra con tu usuario y password, y verás que puedes añadir nuevas publicaciones en el servidor – recuerda, los post que tenías en tu base de datos local no se han subido a al blog publicado en producción.</p>
<p>Después de crear algunas publicaciones, puedes volver a tu instalación local (no la de PythonAnywhere). A partir de ahora, trabaja en tu instalación local para hacer los siguientes cambios. Este es un flujo de trabajo típico en el desarrollo web – haz cambios localmente, sube (push) esos cambios a GitHub, y descarga (pull) tus cambios al servidor de publicación. Esto te permite trabajar y experimentar en local sin romper tu página publicada. Mola, ¿eh?</p>
<p>¡Date una <em>GRAN</em> palmada en la espalda! Desplegar a un servidor es una de las partes más complicadas de desarrollo web y a menudo la gente necesita varios días para que funcione del todo. Pero tú ya tienes tu sitio publicado, ¡en internet de verdad!</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>